# N 层架构

N 层架构意味着将系统拆分为 N 层，N ∈ [1,+∞）。单层架构与单进程架构一样。双层架构和客户端/服务端架构一样等等。

三层架构是一种非常常见的架构。三层架构通常分为表现层/GUI 层、业务逻辑层以及数据持久化层。下图说明了三层体系架构：

![N 层架构.png](https://i.loli.net/2020/12/27/NJvGA7x42BjwEaC.png)

表现层/GUI 层包含应用的用户接口。表现层是“哑巴”，意味着它不包含任何业务逻辑。它只是将用户的操作转发到业务逻辑层。如果用户需要输入信息（例如表单信息），这个可以在表现层中完成。

业务逻辑层做出所有应用程序决策，这就是“业务逻辑”所在的位置。业务逻辑层知道什么是可能的，什么是允许的等等。业务逻辑层在数据持久化层中读取和存储数据。

数据持久化层被用在应用程序中存储数据。数据持久化层通常可以安全地存储数据，执行事务，快速搜索大量数据等。

# Web 和移动应用

Web 应用是非常常见的三层应用程序。表现层由 HTML，CSS 和 JavaScript 组成，业务逻辑层以 Java Servlet/JSP，ASP.NET，PHP，Ruby，Python 等形式在 Web 服务器上运行，数据持久化层由某些数据库（例如 MySQL、PostgreSQL、NoSQL 数据库等）组成。下图是一个典型的三层 Web 应用图：

![三层 Web 应用架构.png](https://i.loli.net/2020/12/27/Hg325hiBMDnKw9R.png)

事实上，对于不是独立应用程序的移动应用程序，这是相同的原理。连接到服务器的移动应用程序通常连接到Web服务器并发送和接收数据。这是典型的三层移动应用程序的示意图：

![三层 Web 应用架构升级版.png](https://i.loli.net/2020/12/27/nBFY97ITvU6qJfm.png)

# 丰富互联网应用程序（Rich Internet Applications - RIA）

在第一代Web应用程序中，许多 HTML 以及部分 CSS 和 JavaScript 是由Web服务器上运行的脚本生成的。当浏览器请求Web服务器上的某个页面时，将在Web服务器上执行脚本，该脚本为该页面生成HTML，CSS和JavaScript。

今天，世界正在转向富互联网应用程序（RIA）。 RIA也使用3层架构，但是所有HTML，CSS和JavaScript都是在浏览器中生成的。浏览器必须下载一次初始的HTML，CSS和JavaScript文件，但是此后RIA客户端仅与Web服务器交换数据。不会来回发送HTML，CSS或JavaScript（除非它是数据的一部分，就像包含HTML代码的文章一样）。

RIA应用程序将在软件体系结构跟踪的下一部分中更详细地说明。

# Web 应用程序的优势

N 层架构的目的是使应用程序的不同层彼此隔离。GUI 客户端不知道服务端内部如何工作，服务端也不知道数据库服务器内部如何工作等等。它们只是通过标准接口进行通信（如前端到后端用 JSON 通信，后端到数据库用 SQL 通信）。

Web 应用程序具有另一个优势，如果您对 GUI 客户端或服务端上运行的应用程序逻辑进行更新，则所有客户端在下次访问应用程序时都会获得最新更新。浏览器下载更新的客户端，更新的客户端访问更新的服务端。



<hr/>

译者补充：

分层架构将软件元素按“层”的方式组织。每个层都有明确定义的职责。分层架构还限制了层之间的依赖关系。每一层只能依赖于紧邻其下方的层（如果严格分层）或其下面的任何层。

流行的三层架构是应用与逻辑视图<sup>[1]</sup>的分层架构。它将应用程序的类组织到以下层中：

+ 表现层
+ 业务逻辑层
+ 数据持久化层

分层架构是架构风格的一个很好的例子，但是有一些明显的弊端：

+ 单个表现层：它无法展现应用程序可能不仅仅由单个系统调用的事实。
+ 单一数据持久化层：它无法展现应用程序可能与多个数据库进行交互的事实。
+ 将业务逻辑层定义为依赖于数据持久化层：理论上，这样的依赖性会妨碍你在没有数据库的情况下测试业务逻辑。

此外，分层架构错误地表示了精心设计的应用程序中的依赖关系。

下面是克服了这些弊端的替代架构：六边形架构。

六边形架构是分层架构风格的替代品。六边形架构风格选择以业务逻辑为中心的方式组织逻辑视图。应用程序具有一个或多个入站适配器（Inbound Adapter），而不是表现层，它通过调用业务逻辑来处理来自外部的请求。同样，应用程序具有一个或多个出站适配器（Outbound Adapter），而不是数据持久化层，这些出站适配器由业务逻辑调用并调用外部应用程序。此架构的一个关键特性和优点是业务逻辑不依赖于适配器。相反，各种适配器都依赖业务逻辑。



> 来自 《微服务架构设计模式》

> 1. 4+1视图模型中的逻辑视图