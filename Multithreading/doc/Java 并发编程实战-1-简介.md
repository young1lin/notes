# 并发简史

操作系统为各个独立执行的进程分配各种资源，包括内存，文件句柄以及安全证书等。如果需要的话，在不同的进程之间可以通过一些粗粒度的通信机制来交换数据，包括：Socket、信号处理器、共享内存、信号量以及文件等。

之所以用操作系统来实现多个程序的同时执行，基于以下几个原因。

+ 资源利用率——可以不用等待一个程序执行完毕再执行下一个程序。
+ 公平性——不同的用户和程序对于计算机上的资源有着同等的使用权。一种高效的运行方式是通过粗粒度的时间分片（Time Slicing）使这些用户和程序能够共享计算机资源。
+ 便利性——通常来说，执行多个任务，应该编写多个程序，而不是一个程序编写多个任务。

线程允许在同一个进程中同时存在多个程序控制流。线程会共享进程范围内的资源，例如内存句柄和文件句柄，但每个线程都有各自的程序计数器（Program Counter）、栈以及局部变量等。线程还提供了一种直观的分解模式来充分利用多处理器系统中的硬件并行性，而在同一个程序中的多个线程也可以被同时调度到多个 CPU 上运行。

线程也被称为轻量级进程。

## 线程优势

1. 发挥多处理器的强大能力；
2. 建模的简单性；
3. 异步事件的简化处理；
4. 响应更灵敏的用户界面。

## 线程带来的风险

1. 提高了编程难度；
2. 安全性问题——非原子操作会不安全例如 i++；
3. 活跃性问题——死锁、届、活锁；
4. 性能问题——频繁上下文切换、修改共享数据时的同步机制。