### 什么是Spring

1. Spring makes it easy to create Java enterprise applications.
2. Spring supports a wide range of application scenarios
3. Spring is open source

Spring是一个开源的，使 Java 企业版应用更容易，支持广泛应用场景的一个框架。

### Spring FrameWork有哪些核心模块

| 序号 | 模块 | 介绍 |
| :---: | :---: | :---: |
| 1 | Spring-core | Spring基础API模块，如资源管理，范型处理 |
| 2 | Spring-beans | 依赖查找，依赖注入等 |
| 3 | Spring-aop | 动态代理，AOP字节码提升 |
| 4 | Spring-context | 事件驱动，注解驱动，模块驱动 |
| 5 | Spring-expression | 表达式语言 |

### Spring的优势与不足

优势

+ 使企业应用更简单，整合了多方内容



不足

+ 



### 什么是 IoC ？

Inversion of Control，中文名叫控制反转，主要有依赖查找和依赖注入两种方式，通过构造器注入/setter注入

### 依赖查找和依赖注入的区别

依赖查找是主动或手动的依赖查找方式，通常需要依赖容器或标准API实现。二依赖注入则是手动或自动依赖绑定的方式，无需依赖特定的容器和API。

### Spring作为IoC容器有什么优势？

+ 典型额度IoC管理，依赖查找和依赖注入

+ AOP抽象

+ 事务抽象

+ 事件机制

+ SPI扩展

+ 强大的第三方整合（MyBatis，MQ）

+ 易测试性

+ 更好的面相对象



### 什么是IoC容器

Spring Framework是实现一个依赖反转的原则，DI就是IOC实现的一种。

### BeanFactory和FactoryBean

BeanFactory是 IOC 底层容器

FactoryBean是创建Bean的一种方式，帮助实现复杂的初始化逻辑。在执行doGetBean的时候，如果该BeanDefinition中来获取类是否instanceof FactoryBean，如果是，就执行其中个getObject方法，然后跳过默认初始化Bean方法。

### Spring IoC 容器启动时做了哪些准备

IOC 配置元信息读取和解析、IOC容器生命周期、Spring事件发布、国际化等。

### 如何注册一个Bean

通过BeanDefinition和外部单体对象来注册

### 什么是BeanDefinition

### Spring Bean 生命周期

1. Spring Bean 元信息配置阶段
2. Spring Bean 元信息解析阶段
3. Spring Bean 注册阶段
4. Spring BeanDefinition 合并阶段
5. Spring Bean Class 加载阶段
6. Spring Bean 实例化前阶段
7. Spring Bean 实例化阶段
8. Spring Bean 实例化后阶段
9. Spring Bean 属性赋值前阶段
10. Spring Bean Aware 接口回调阶段
11. Spring Bean 初始化前阶段
12. Spring Bean 初始化阶段
13. Spring Bean 初始化后阶段
14. Spring Bean 初始化完成阶段
15. Spring Bean 销毁前阶段
16. Spring Bean 销毁阶段
17. Spring Bean 垃圾收集



### BeanPostProcessor 的使用场景有哪些

Spring Bean 初始化前和初始化后的生命周期回调，允许对自己定义条件的 Bean 进行扩展，甚至是替换。

如果返回 null 则不做调整，如果有值，则替换 Bean

```java
default Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
    return bean;
}
```

```java
@Nullable
default Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
    return bean;
}
```

其中，ApplicationContext 相关的 Aware 回调也是基于 BeanPostProcessor 实现，即 ApplicationContextAwareProcessor





### BeanFactoryPostProcessor 和 BeanPostProcessor 的区别

 BeanFactoryPostProccessor 是 Spring BeanFactory 实际为 ConfigurableListableBeanFactory 的后置处理器，用于扩展 BeanFacotry，或通过 BeanFactory 进行依赖查找和依赖注入。

 BeanFactoryPostProcessor 必须有 Spring ApplicationContext 执行，BeanFactory 无法与其直接交互。

而 BeanFactoryPostProcessor 则直接与 BeanFactory 关联，属于 N 对 1 的关系。



### BeanFactory 是怎样处理 Bean 生命周期的？

BeanFactory 的默认实现是 DefaultListableBeanFactory，其中 Bean 生命周期与方法映射如下：

+ BeanDefinition 注册阶段 - registerBeanDeifinition
+ BeanDefinition 合并阶段 - getMergedBeanDefinition
+ Bean 实例化前阶段
+ Bean 实例化阶段
+ Bean 实例化后阶段
+ Bean 属性赋值前阶段
+ Bean 接口回调阶段
+ Bean 初始化前阶段
+ Bean 初始化阶段
+ Bean  初始化后阶段
+ Bean 初始化完成阶段
+ Bean 销毁前阶段
+ Bean 销毁阶段

1.查找bean的入口 org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean
2.创建bean org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBean(java.lang.String, org.springframework.beans.factory.support.RootBeanDefinition, java.lang.Object[])
3.执行创建bean org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean
4.填充bean的属性 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#populateBean
5.给bean的属性 org.springframework.beans.factory.config.InstantiationAwareBeanPostProcessor#postProcessProperties
6.属性赋值 org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor#postProcessProperties
7.执行注入 org.springframework.beans.factory.annotation.InjectionMetadata#inject
8.字段注入 org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.AutowiredFieldElement#inject
9.依赖注入 org.springframework.beans.factory.support.DefaultListableBeanFactory#resolveDependency